import clsx from 'clsx'

interface Props {
  metricType: 'bounce_rate' | 'return_rate' | 'depth' | 'avg_time'
  avgValue: number
}

const METRIC_INSIGHTS = {
  bounce_rate: {
    thresholds: { low: 30, high: 60 },
    messages: {
      low: '–û—Ç–ª–∏—á–Ω—ã–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å –æ—Ç–∫–∞–∑–æ–≤! –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–∞—Ö–æ–¥—è—Ç —Ç–æ, —á—Ç–æ –∏—â—É—Ç, –∏ –æ—Å—Ç–∞—é—Ç—Å—è –Ω–∞ —Å–∞–π—Ç–µ.',
      normal: '–ù–æ—Ä–º–∞–ª—å–Ω—ã–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å –æ—Ç–∫–∞–∑–æ–≤. –ï—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞.',
      high: '–í—ã—Å–æ–∫–∏–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å –æ—Ç–∫–∞–∑–æ–≤. –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∏ —É–ª—É—á—à–∏—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏—é.',
    },
  },
  return_rate: {
    thresholds: { low: 20, high: 40 },
    messages: {
      low: '–ù–∏–∑–∫–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç –≤–æ–∑–≤—Ä–∞—Ç–æ–≤. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —É–ª—É—á—à–∏—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç –∏ —Å–µ—Ä–≤–∏—Å—ã, —á—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–æ–∑–≤—Ä–∞—â–∞–ª–∏—Å—å —á–∞—â–µ.',
      normal: '–•–æ—Ä–æ—à–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç –≤–æ–∑–≤—Ä–∞—Ç–æ–≤. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –∫ –≤–∞—à–∏–º —Ä–µ—Å—É—Ä—Å–∞–º.',
      high: '–û—Ç–ª–∏—á–Ω—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç –≤–æ–∑–≤—Ä–∞—Ç–æ–≤! –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Ä–µ–≥—É–ª—è—Ä–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è, —á—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–º –∫–æ–Ω—Ç–µ–Ω—Ç–µ.',
    },
  },
  depth: {
    thresholds: { low: 2, high: 4 },
    messages: {
      low: '–ù–∏–∑–∫–∞—è –≥–ª—É–±–∏–Ω–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞. –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º –¥–æ–±–∞–≤–∏—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Å—Å—ã–ª–∫–∏ –∏ —É–ª—É—á—à–∏—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏—é –º–µ–∂–¥—É —Ä–∞–∑–¥–µ–ª–∞–º–∏.',
      normal: '–ù–æ—Ä–º–∞–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–∑—É—á–∞—é—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–∞–Ω–∏—Ü –∑–∞ –≤–∏–∑–∏—Ç.',
      high: '–û—Ç–ª–∏—á–Ω–∞—è –≥–ª—É–±–∏–Ω–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞! –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∞–∫—Ç–∏–≤–Ω–æ –∏–∑—É—á–∞—é—Ç –≤–∞—à–∏ —Ä–µ—Å—É—Ä—Å—ã.',
    },
  },
  avg_time: {
    thresholds: { low: 60, high: 180 },
    messages: {
      low: '–ö–æ—Ä–æ—Ç–∫–æ–µ –≤—Ä–µ–º—è –Ω–∞ —Å–∞–π—Ç–µ. –í–æ–∑–º–æ–∂–Ω–æ, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∏–ª–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞.',
      normal: '–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –Ω–∞ —Å–∞–π—Ç–µ. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–∞—Ö–æ–¥—è—Ç –Ω—É–∂–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏ —É–¥–µ–ª—è—é—Ç –≤—Ä–µ–º—è –∏–∑—É—á–µ–Ω–∏—é.',
      high: '–í—ã—Å–æ–∫–æ–µ –≤—Ä–µ–º—è –Ω–∞ —Å–∞–π—Ç–µ! –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∞–∫—Ç–∏–≤–Ω–æ –≤–æ–≤–ª–µ—á–µ–Ω—ã –≤ –∫–æ–Ω—Ç–µ–Ω—Ç –∏ —Å–µ—Ä–≤–∏—Å—ã.',
    },
  },
}

export default function MetricInsightHint({ metricType, avgValue }: Props) {
  const config = METRIC_INSIGHTS[metricType]
  const { low, high } = config.thresholds

  let level: 'low' | 'normal' | 'high' = 'normal'
  if (avgValue < low) {
    level = metricType === 'return_rate' || metricType === 'depth' || metricType === 'avg_time' ? 'low' : 'high'
  } else if (avgValue >= high) {
    level = metricType === 'bounce_rate' ? 'high' : 'high'
  }

  // –î–ª—è bounce_rate –ª–æ–≥–∏–∫–∞ –∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è (–Ω–∏–∑–∫–∏–π = —Ö–æ—Ä–æ—à–æ)
  if (metricType === 'bounce_rate') {
    if (avgValue < low) level = 'high'
    else if (avgValue >= high) level = 'low'
    else level = 'normal'
  } else {
    if (avgValue < low) level = 'low'
    else if (avgValue >= high) level = 'high'
    else level = 'normal'
  }

  const message = config.messages[level]

  return (
    <div
      className={clsx(
        'mt-3 px-3 py-2 rounded-lg text-xs leading-relaxed',
        level === 'high' && 'bg-green-50 text-green-700 border border-green-200',
        level === 'normal' && 'bg-yellow-50 text-yellow-700 border border-yellow-200',
        level === 'low' && 'bg-red-50 text-red-700 border border-red-200',
      )}
    >
      üí° {message}
    </div>
  )
}
